const dados = {
    "inscricao_municipal":[1245530335001,3080170231001,1150760494001,3020960507046,1060560230012,1225390876007,1220770070001,1160680110001,3040390068001,1225432596054,1160530862054,1161170100001,3021510179001,1210070144001,1110380090001,1250110528001,1143140147001,1060320716007,1251510228001,1141030605001,1280420300001,1230470245001,1299990919405,1110600273001,3080820382019,3040260320006,3020140162001,1262170264001,2060380701001,1245390380001,1251820130001,1230400380001,1270940181001,1180270033001,1151240265001,3240180635006,1100080781149,3249990646344,1490250528001,1270900115001,3021200135001,2030520024001,1180120034001,1141740524001,3020210055001,1231510220001,1490820497001,1250350258001,3020610030001,1100080781072,1145330509001,1260950430001,3020300151001,1270070274001,1251130348001,1035330421001,1035330421001,1070030652001,3210660800022,3020190018001,3020610030001,3020300243001,1299990919084,1100080781055,3210400558355,1181110594001,1260950430001,1145330509001,1150650270001,1250560143001,1141740536001,3020200099001,3020850200001,1150650270001,3020210083001,1295171024171,1141740546001,3120050048002,3020210030001,1245570510001,3130270400006,1280420110001,1271120240001,1111680197001,1142010010013,1140540495001,1140540590041,1151240265001,1220770090001,3210660300088,3240500106011,1226812779026,1100151269143,1141270191001,2060110319001,1141181054001,2060110299001,3249990646207,1230130400001,1142110550001,1295180476071,1490040008001,1225391150042,3245121196107,1490650093001,1260250273001,2060110319001,1035270114001,1299990919287,2060110310001,1295073649107,1270070352001,1226812586076,1060650460023,1140950092001,2061050166003,1145460333001,1231110235001,1110510216001,2040850052001,1245721815192,1190060317001,1300690395002,2050850478001,1230120434001,3021030167001,3140590540006,1100080781049,1490320032001,1295170428006,1289990376092,1160530862122,1150760030001,3240500564067,3139990425001,1490650103001,2040810330006,3130270400061,1330590448001,1183031046139,1110630091001,1035270114001,1225390876054,1110350300001,14262134,1141560319001,1295290397001,2039990023157,1220630033001,1300590070001,1250320130001,1260070485001,1070100474001,1336840123001,1260850130001,1245514642120,3020300051001,3240260406001,1335450656103,3130120500002,1230360140001,2041110050001,1295101596060,1100020659001,1280960257001,3021280195001,1230070340001,3240260426001,1260850130001,1140660140001,3040070100002,1282100014001,1180520024001,2039990093107,1250900050001,1281390333001,1250900060001,1295470296001,1490250584001,3240260416001,1282020160001,1225391150103,1295470296001,2040630315001,1280960245001,1251870521001,1300590060001,2041130010001,1250790020001,1230340145001,1142510105001,1299990919264,1060820527001,1145460333001,1220630168001,1210070144001,1251060085001,3040330500001,1160390253001,1143020525001,1351010230001,14253071,1300490080001,1280810006001,1120570190001,1140090080001,1143150279001,1170200369001,1245514642258,1245050136202,1295170428057,1290010040001,1211420220001,1500060180001,2040690377001,1100151269166,2061030272001,1180760470001,1245514642211,3020900306034,1140540590052,3080380538702,1143080068001,2060110329001,1295072891113,1270420175001,1220770080001,2050720931046,1335440040001,1245390380001,1261010120001,1142470537001,1250360416001,1060740073001,3245121111001,3130440420001,3020120380001,1261010120001,1110370193001,3130200370007,3020120370001,1250520245001,3020120310001,1282120335001,1281411545028,1261270014001,3130440420001,3130570055001,3020230262001,3020120400001,1250710417001,1350370020001,3130570055001,3020600283001,1140930177001,3130570600027,1181120351001,3249990663032,1262170529001,1180120001001,1151100130001,1100080781183,1150540169001,1245050136262,3150950089087,1281390055001,3240120293015,1151100130001,1226812586323,1150540169001,1350680455001,1295170428058,1161300130001,1141110207001,1300760020001,1160530862061,3240120293002,1150790360001,1035300447001,1035300447001,1262200700001,1271140204001,3210660800005,1146080170001,1151170335001,1150700260001,1295072555059,3249990646152,1296030129001,3210660800127,1275040153001,3010720054013,1146080170001,1105230241001,2060280340005,3030240060001,1250310190001,1495010237001,2060280340002,3020900306017,2060280340001,3021270361001,1160940060001,2040560190001,1170160072001,1100080781006,1146310394001,3020120022001,1180900521001,3021160450001,1146310394001,1110560109001,2060280340004,1491080424001,1181400011071,3150940700045,2040560190001,1270600070001,1181690573001,3150080040001,2060280340003,3150940700025,3020020155006,2040960050001,1150060500001,1180900534001,1180740461001,1231010300001,1162010274001,1060670318001,1231200348001,1035600298001,3020900306003,1111190255001,1142320060001,3010160088001,1295340323001,1160430269001,1245050136096,1231200348001,1286570022001,1120240221001,1111490240001,1060670873001,3245121332033,3249990140199,1035600298001,1295340308001,3090360317001,1120240201001,1295340323001,1175010036001,1175010036001,1211420232001,1142010010095,1121050570009,1111370188001,1290120172001,1250700034001,3021420310036,1142010006129,3021490169001,1261370300001,1245530335001,3130580600009,3020120390001,1490250584001,1251280080001,1141400206001,2030860319001,1190050239001,1251870531001,1111670400001,1151240395001,3021450362001,1491020343001,3210400558226,3021040042001,3010660245001,3090290218001,3249990140344,2040490499003,2050540291001,1245514642144,1160850496001,3080820449059,2039990102004,1500060180001,1070160532021,1251490185001,3040200520001,1251050325001,1280810007001,3080410143024,1289990376011,3130180640016,3240500509091,2040690387001,3040380215001,3240010154007,1226812779118,2050240356022,1245580130001,1296040419001,3020760430001,3249990646210,1250360446001,1350080620001,1140730110001,2030580062010,1190600042001,1120870240006,1281400003129,1336440378001,1225432450046,3100181269100,3020510250001,1250950415001,1165040593001,1295181030501,1351170335001,1225432429022,1210130580001,3150940700028,1226812586151,1220750080001,1160070140001,3021430345015,1140220130001,3200370182001,1140080290001,1250460090001,3249990140272,1295171387013,1280650165001,1210130580001,1210240525001,1161360247001,1282000336001,3240500701058,1220730210001,1150320250001,3080060335001,1190670233001,3151250302001,2030600057008,1350010704001,3090430273063,2060550529001,1160530862065,1300550130001,1295610070001,1111310110001,1295350043001,1261000270001,1160850062001,1180570476001,1295101596081,1300910030001,1111310030001,1111310080001,3040110123001,1111310030001,1160040240001,1010490443001,1111670131001,1070090392001,3240050313001,3230380065001,2040820348001,1111310100001,3040110173001,1245570043001,3010760090001,1251810132001,1295350043001,3150290267001,1231100015001,1120080325040,1146360318001,1289990376057,1111310040001,1231050265001,1183020630014,3240340427018,1120150512005,1120540250001,1290190030001,1150920310001,1120820230001,2050680012001,1150910355001,1111310080001,3251050020001,1111310040001,1350010735001,2050280181001,1111250195001,1121050656001,1111310100001,3011130480012,1220730110001,1295600165001,1261000270001,1350140295001,1120610015001,1150910345001,1295610070001,1111310010001,1142090240001,3280810004001,3249990140025,1295600165001,3021370105001,1150780506001,1226150030001,3180500061001,1150910355001,1140090080001,1350140215001,1070160613001,1170200449001,1219990033036,1111200345001,1350140215001,1245570043001,1280760010001,3150290267001,1110110106001,1220630146001,1141670110001,1300600490001,1111310329001,3249990555110,1280840071001,1120550226001,1290470242001,1100150792039,1251820080001,1295390137001,1210940405001,1110400156001,3180600032001,1299991063371,1140030275001,3249990181033,1100120321015,1035300095001,1100150792039,1111200075001,3020490260001,1250180034001,3130720080001,2050740554001,3240500106046,1160620202001,1110390040001,1226812779189,3245010136001,1250110330001,1150820294001,1110190241001,1190680048001,2039990054014,1160410312001,3210400558088,1261690097001,1295181030163,3011450104001,1140760337001,1295101730009,3011510080001,1110400070001,1035300095001,1270130120001,3040310412001,3080140205001,1105152344087,1110400070001,3020140313001,3249990646058,1110160100001,1490320552001,1143040170001,1145370043001,3040140017001,1352210040001,1251050365001,1160530862052,1060320284041,1140360012001,1160440558001,1111230421001,2060250497001,1146480387001,1150590169001,1210210435001,1205160016001,2050680012001,3240500701014,1211100531001,2040930445001,1150300075001,1246011032146,1335190077001,3261890325002,1210210150001,3080410143035,3240180273001,2050930249001,1299990919144,1150610385001,1180560020001,1286430039001,1330110440001,1110740056001,1111370188001,1146480387001,1225150448001,2050930236001,3021090040001,1140450015001,1490170137001,1151260024001,1282170070001,1260901336001,1200420096001,1105152264002,1161340342001,1170250426001,1245560537001,1120880555001,3020130151001,1221340290001,1150300060001,1185510799001,1270030220001,1251140115001,1350740145001,1282040180001,3090430273116,1295180476084,1146570375001,3040060310001,1295960157001,1290350120001,3249990555054,1352210624001,1210210570001,1183020680068,1250250217001,1351440050001,1300540090001,1230070580001,1120880555001,1180470156001,1191211170024,1140360012001,1180460546001,1160230043001,1105151900010,3251630254001,1060320284014,2050710705001,1146030207001,3210660800203,1351320275001,1245050136317,3240180273001,1261350220001,1210450366001,1250640413001,3249990646025,2050680444001,3245010034001,1245721815361,1352210495001,3139990490001,3240180285001,1245510140001,2040730059002,1300590020001,1111100120001,1140310350001,3240180285001,1180500128001,1035070506001,2040920309001,1150720120001,1111240586001,3100181269082,2039990023111,2050870520001,3011220030034,3230110390001,1141530739001,1250110460001,1295073649003,3130200390001,1295360234001,2039991618122,1280590168001,1295100698037,1350200040001,3090090312001,1060320284069,1180190001001,1295340132001,1160680080001,3210400558119,2031200800003,1060770188005,1151230218001,1352210495001,3010380151001,1185560385001,1490230240001,1140520165001,1245710290001,1261910254001,1270130340001,1150760404001,1151230329001,1295440340001,1142600250001,2041110936001,1035220410001,1295440340001,1180270023001,1250440073001,3040010323001,3245121196113,3245120982015,1350140345001,1105152344186,1291150445001,1105152344186,1295340132001,1295280200001,1146590380001,1250480192001,1210200534001,1295101596088,1295360234001,1250390077001,1180260028001,1352210030001,1180460661001,1180930214001,1140540590068,1345440261001,1161300020001,1161100645001,1200150186001,1140310365001,1070050154001,2040930165001,1142460125001,1295100698181,1150160460001,1260090450001,1245620072001,1226812586041,1060950410001,1146030340001,3180570017001,3080850050001,2040930360001,3100181269028,1490770137001,3090300310001,3240180297001,1230910537003,1145440171001,1270790110001,1290240070001,1120880570001,1110160150001,1146030207001,3011220030066,1352210505001,2040500180001,1270160285001,1205010056001,3020020420001,1120380195001,2050491366006,1286220181001,1035270083001,3240230063028,1226812586147,1282100014001,1150300075001,1100030397048,1210300288001,1210290468001,3010910010001,3210400558306,1142110726001,1155030230001,3020560230001,1261170473001,2050660198001,1245700434001,1105152264022,1146590380001,1142200095001,1291150445001,1246011032147,3020500355011,1330240216001,1250820250001,3249990663031,1245620072001,2041010079001,1161220433001,1350010694001,1330110096001,1142540050001,2039990023085,3080820277001,1140310350001,1210180088001,1180830313001,2040930435001,1295181030042,1290080060001,3020010146001,2050250199001,1150910035001,1120880180001,1120360180004,1295340117001,1142460125001,2030970340001,3030250266002,3285090088001,1280880538001,1286220169001,1270040220001,3240500043007,1191211170034,1510340370001,2040930360001,3130140400006,2039991618080,1295101730070,1146030197001,1170400324001,1170400386001,1295280200001,1221320240001,3020850190001,3090190092001,1141900269001,2039990188001,1170400403001,2040560605058,1270940116001,1100030397078,1330260424001,1111100120001,3240180338001,1510340370001,3010660285001,1180580463001,1142110484001,1120550216001,1245510169001,1295450344001,1299991063392,1283010974145,1140450295001,2060970404001,1250520050001,3020020392001,1120650330001,1120870240032,2041090140001,1280880010001,3010930074001,1105090030001,3139990018012,1180050018001,1490550478001,1295171024047,2050680444001,1105150091008,1035270083001,3030040042001,1150300060001,3090430273062,1150450186033,1160530862053,1146030340001,1345490177001,1110070322001,1210660366001,1260950500001,3150190680001,3240230271036,2060350181001,1230630040001,1110010267001,1282030293001,1185560385001,1262040445001,3010930074001,2039991618141,3030250266006,1140320437004,2030950359002,2060460317001,1350140315001,1105152344079,1145450256001,1250680245001,1183041249106,1225432429130,3030250266001,1140450015001,1161380175001,1245590444001,1146030197001,1270250230001,3040180495001,3230110390001,2050631530001,1100130767001,3010380040001,2050010681015,2040730059001,1180910460001,1111260540001,3021310170001,1299991573159,3240340167015,1250440123001,1245550389001,1181060013001,3130140400106,1282030293001,2050260262001,3011230147005,3030250266003,1146570375001,1111060453001,1100080781176,1035220123001,1155090330001,2039990093069,3262080287001,1180420057001,1180910012001,1142540295001,1070110290001,1111610314001,1251810122001,1210380192001,1295450344001,1300090449001,3240180297001,3040060310001,3020020406001,1282030283001,1070080098002,1280860224001,1295072555097,1230530460001,3020350144001,3080140010001,2030960189008,1295180476020,1180150010001,3250650302001,2050630418001,3021040279001,3010880538001,3040430010006,3010600399008,2031110020001,1146030350001,1290540243001,1200140202001,2040920309001,1183041249223,1210210045001,1150490050001,3020040499001,2060130249002,1280930230001,3021410174001,1100130810001,1120170640031,1210190160001,1160490119001,1490850600001,1161100645001,1200150267001,3100181269117,1190600408016,1170140085001,1230530460001,1355670179001,1160530862135,3210660300224,1295171024118,1245550389001,1145450256001,1160760428090,2050220129001,1180800561001,1352210030001,2040680178001,1110080412001,3021310315001,3090350045001,1226812586255,3030250266004,1141690300001,1120900172001,1352210505001,1205680300001,3100161147002,1146280389001,1111060453001,1110080242001,1245700434001,1100140556005,1336830291001,2040930030003,1245050136318,3130200390001,3080090223013,1060650460007,1261560913001,2039990116001,1261440642001,3249990646207,3249990646207,3249990646207,14253071,14253071,14253071]
};
function formatarCPF(cpf) {
    return cpf.replace(/^(\d{3})(\d{3})(\d{3})(\d{2})$/, "$1.$2.$3-$4");
}

function formatarCNPJ(cnpj) {
    return cnpj.replace(/^(\d{2})(\d{3})(\d{3})(\d{4})(\d{2})$/, "$1.$2.$3/$4-$5");
}

function aplicarMascara() {
    let campo = document.getElementById('pesquisa_cnpj_cpf');
    let valor = campo.value.replace(/\D/g, '');

    valor = valor.slice(0, 14);

    if (valor.length <= 11) {
        campo.value = formatarCPF(valor);
    } else if (valor.length <= 14) {
        campo.value = formatarCNPJ(valor);
    }
}

document.getElementById('pesquisa_cnpj_cpf').addEventListener('input', aplicarMascara);

function buscarCNPJCPF(pesquisa) {
    return dados.numero_documento_juridico.includes(pesquisa);
}

function buscarInscricaoMunicipal(pesquisa) {
    const pesquisaNumerica = parseInt(pesquisa, 10);
    return dados.inscricao_municipal.includes(pesquisaNumerica);
}

function realizarPesquisaCNPJCPF() {
    const pesquisaCNPJCPF = document.getElementById('pesquisa_cnpj_cpf').value;
    let resultado = document.getElementById('resultado');
    resultado.classList.remove('erro', 'sucesso', 'nao-encontrado');

    if (pesquisaCNPJCPF) {
        if (buscarCNPJCPF(pesquisaCNPJCPF)) {
            resultado.classList.add('sucesso');
            resultado.innerHTML = `Este CPF/CNPJ possui valor a ser restituído em decorrência de recolhimento indevido da tarifa de Expediente no valor de R$. 10,37.<br>
            Para restituir, <a href="https://form-restituir.vercel.app/" target="_blank" style="color:#155724; font-weight:bold; text-decoration:underline;">clique aqui para acessar o formulário</a> e siga as orientações nele previstas.`;
        } else {
            resultado.classList.add('erro');
            resultado.innerText = "Sem valor a ser restituído - não houve pagamento da tarifa de expediente indevida.";
        }
    } else {
        resultado.classList.add('nao-encontrado');
        resultado.innerText = "Por favor, insira um CPF ou CNPJ.";
    }

    setTimeout(function() {
        resultado.innerText = '';
        resultado.classList.remove('erro', 'sucesso', 'nao-encontrado');
    }, 20000);
}

function aplicarLimiteInscricao() {
    let campo = document.getElementById('pesquisa_inscricao');
    campo.value = campo.value.replace(/\D/g, '').slice(0, 15); // Só números e no máximo 15 dígitos
}

function realizarPesquisaInscricao() {
    const pesquisaInscricaoMunicipal = document.getElementById('pesquisa_inscricao').value;
    let resultado = document.getElementById('resultado');
    resultado.classList.remove('erro', 'sucesso', 'nao-encontrado');

    if (pesquisaInscricaoMunicipal) {
        if (buscarInscricaoMunicipal(pesquisaInscricaoMunicipal)) {
            resultado.classList.add('sucesso');
            resultado.innerHTML = `Esta Inscrição possui valor a ser restituído em decorrência de recolhimento indevido da tarifa de Expediente no valor de R$. 10,37.<br>
            Para restituir, <a href="https://form-restituir.vercel.app/" target="_blank" style="color:#155724; font-weight:bold; text-decoration:underline;">clique aqui para acessar o formulário</a> e siga as orientações nele previstas.`;
        } else {
            resultado.classList.add('erro');
            resultado.innerText = "Sem valor a ser restituído - não houve pagamento da tarifa de expediente indevida.";
        }
    } else {
        resultado.classList.add('nao-encontrado');
        resultado.innerText = "Por favor, insira uma Inscrição Imobiliária.";
    }

    setTimeout(function() {
        resultado.innerText = '';
        resultado.classList.remove('erro', 'sucesso', 'nao-encontrado');
    }, 20000);
}

document.getElementById('btnPesquisaCNPJCPF').addEventListener('click', function(e) {
    e.preventDefault();
    realizarPesquisaCNPJCPF();
});

document.getElementById('btnPesquisaInscricao').addEventListener('click', function(e) {
    e.preventDefault();
    realizarPesquisaInscricao();
});

document.getElementById('pesquisa_inscricao').addEventListener('input', aplicarLimiteInscricao);
